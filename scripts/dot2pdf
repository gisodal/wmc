#!/bin/bash

FILE=$1
NAME=${FILE%.*}
EXTENSION=${FILE##*.}
EXPORT=eps

if [ "$EXTENSION" == "dot" ]; then
    dot -T$EXPORT $FILE -o ${NAME}.$EXPORT
    mkdir -p tex
    OUTPUT=tex/paper.tex
    cp ${NAME}.$EXPORT tex/image.eps
    echo -n '\documentclass{article}
    \usepackage{graphicx}
    \usepackage{pdflscape}
    \usepackage[margin=0.5in]{geometry}
    \begin{document}
        \pagenumbering{gobble}
        \begin{landscape}
                \includegraphics[width=\linewidth,height=\textwidth,keepaspectratio]{' > $OUTPUT
        echo -n "image.eps" >> $OUTPUT
        echo '}
        \end{landscape}
    \end{document}' >> $OUTPUT

    cd tex
    pdflatex paper.tex 1>/dev/null
    cd ..
    cp tex/paper.pdf ${NAME}.pdf
    rm -rf tex
    echo ${NAME}.pdf created..

    if [ $# -gt 1 ]; then
        evince ${NAME}.pdf 2>/dev/null &
    fi
else
    echo "Usage: ./dot2ps <DOT FILE>" 1>&2
fi

